<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div style="border:2px solid black; padding:10px">

# <font color="blue">Objective: </font>Describe the process used to calculate the theta best.
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Import-Dependencies">Import Dependencies<a class="anchor-link" href="#Import-Dependencies">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Python ≥3.5 is required</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">assert</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># Scikit-Learn ≥0.20 is required</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
<span class="k">assert</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&gt;=</span> <span class="s2">&quot;0.20&quot;</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Load data</span>
<span class="o">%</span><span class="k">store</span> -r X
<span class="o">%</span><span class="k">store</span> -r y
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr style="border-top: 2px solid black;">
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Linear-regression-using-the-Normal-Equation">Linear regression using the Normal Equation<a class="anchor-link" href="#Linear-regression-using-the-Normal-Equation">&#182;</a></h1><ul>
<li>Linear Regression Modeling using Cost Function</li>
<li>Cost function measures the distance between the linear model's prediction and the training examples.</li>
<li>It measures how bad the model is at predicting.</li>
<li>The linear model finds the best parameters that make the model fit best to the data.</li>
<li>Normal Equation is an analytical approach to Linear Regression with a Least Square Cost Function. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Normal-Equation">Normal Equation<a class="anchor-link" href="#Normal-Equation">&#182;</a></h1><p><img src="static/images/normal_equation.png" alt="html" class="background-pic" width="25%" height="10%"></p>
<ul>
<li>Hat theta (theta_best) is the value of the theta parameter that minimizes the cost function</li>
<li>y is the vector of the target we are to predict</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr style="border-top: 2px solid black;">
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="The-theta_best-can-be-calcualted-in-two-steps.-The-following-code-will-explain-these-steps-more-carefully,-and-show-you-what-the-data-should-look-like-at-each-step.-This-will-help-you-troubleshoot-your-own-projects-using-this-model.">The theta_best can be calcualted in two steps. The following code will explain these steps more carefully, and show you what the data should look like at each step. This will help you troubleshoot your own projects using this model.<a class="anchor-link" href="#The-theta_best-can-be-calcualted-in-two-steps.-The-following-code-will-explain-these-steps-more-carefully,-and-show-you-what-the-data-should-look-like-at-each-step.-This-will-help-you-troubleshoot-your-own-projects-using-this-model.">&#182;</a></h1><ul>
<li>Step 1: <code>X_b = np.c_[np.ones((len(X), 1)), X]</code></li>
<li>Step 2: <code>theta_best = np.linalg.inv(X_b.T.dot(X_b).dot(X_b.T).dot(y)</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Explain-the-theta_best-calculation-of-The-Normal-Equation-in-5-Steps">Explain the theta_best calculation of The Normal Equation in 5 Steps<a class="anchor-link" href="#Explain-the-theta_best-calculation-of-The-Normal-Equation-in-5-Steps">&#182;</a></h1><ul>
<li>Step 1: Create a 2D Array  <code>X_b</code> from <code>X</code><ul>
<li><code>X_b</code> will containing two values per instance <code>1, and GDP per country</code></li>
</ul>
</li>
<li>Step 2: Create a new Matrix <code>X_b_transposed</code><ul>
<li><code>X_b_transposed</code> is the Transposed Matrix of <code>X_b</code></li>
</ul>
</li>
<li>Step 3: Create a new Matrix <code>mm</code><ul>
<li>mm is obtained by multiplying <code>X_b_transposed</code> by <code>X_b</code></li>
</ul>
</li>
<li>Step 4: Create a new Matrix <code>inv_matrix</code><ul>
<li>This matrix is the inverse of the <code>mm</code> matrix</li>
</ul>
</li>
<li>Step 5: Calculte the optimal parameter Theta_best $\hat{\theta}$<ul>
<li>theta_best = <code>inv_matrix.dot(X_b.T).dot(y)</code></li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Reminder:-the-X-is-a-stacked-array-with-the-GDP-per-capita-for-each-country">Reminder: the <CODE>X</CODE> is a stacked array with the GDP per capita for each country<a class="anchor-link" href="#Reminder:-the-X-is-a-stacked-array-with-the-GDP-per-capita-for-each-country">&#182;</a></h1><ul>
<li>This is our 'independent variable'</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[ 50961.87],
       [ 43724.03],
       [ 40106.63],
       [ 43331.96],
       [ 17256.92],
       [ 52114.17],
       [ 41973.99],
       [ 37675.01],
       [ 40996.51],
       [ 18064.29],
       [ 12239.89],
       [ 50854.58],
       [ 51350.74],
       [ 29866.58],
       [ 32485.55],
       [ 27195.2 ],
       [101994.09],
       [  9009.28],
       [ 43603.12],
       [ 37044.89],
       [ 74822.11],
       [ 12495.33],
       [ 19121.59],
       [ 15991.74],
       [ 25864.72],
       [ 49866.27],
       [ 80675.31],
       [  9437.37],
       [ 43770.69],
       [ 55805.2 ],
       [  8670.  ],
       [ 13340.91],
       [ 17288.08],
       [ 35343.34],
       [ 13618.57],
       [  9054.91],
       [ 20732.48],
       [  5694.57],
       [  6083.51],
       [ 14210.28]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(40, 1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div style="border:1px solid black; padding:10px">

<font color="blue">Note:</font><br>
 - 40 is the number of GDPs 
 - 1 is the number of 'columns' in this X array

</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr style="border-top: 2px solid black;">
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Step-1:-Create-a-2D-Array-X_b-that-contains--1-and--X-per-instance.-The-X-contains-the-GDP-per-country">Step 1: Create a 2D Array <code>X_b</code> that contains  <code>1</code> and  <code>X</code> per instance. The X contains the GDP per country<a class="anchor-link" href="#Step-1:-Create-a-2D-Array-X_b-that-contains--1-and--X-per-instance.-The-X-contains-the-GDP-per-country">&#182;</a></h1><p>Use numpy's np.c_ and np.ones()</p>
<ul>
<li>np.c_ : Translates slice objects to concatenation along the second axis.</li>
<li>Documentation as of 5/15/20:<ul>
<li><a href="https://numpy.org/devdocs/reference/generated/numpy.c_.html">https://numpy.org/devdocs/reference/generated/numpy.c_.html</a></li>
</ul>
</li>
<li>np.ones(): Return a new array of given shape and type, filled with ones.</li>
<li>Documentation as of 5/15/20:<ul>
<li><a href="https://numpy.org/devdocs/reference/generated/numpy.ones.html">https://numpy.org/devdocs/reference/generated/numpy.ones.html</a></li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># add x0 = 1 to each instance, </span>
<span class="c1"># and then it also adds the GPD from the X array</span>
<span class="c1"># np.c_ creates the stacked 2d array out of those values</span>
<span class="n">X_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">40</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">X</span><span class="p">]</span>
<span class="n">X_b</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1.0000000e+00, 5.0961870e+04],
       [1.0000000e+00, 4.3724030e+04],
       [1.0000000e+00, 4.0106630e+04],
       [1.0000000e+00, 4.3331960e+04],
       [1.0000000e+00, 1.7256920e+04],
       [1.0000000e+00, 5.2114170e+04],
       [1.0000000e+00, 4.1973990e+04],
       [1.0000000e+00, 3.7675010e+04],
       [1.0000000e+00, 4.0996510e+04],
       [1.0000000e+00, 1.8064290e+04],
       [1.0000000e+00, 1.2239890e+04],
       [1.0000000e+00, 5.0854580e+04],
       [1.0000000e+00, 5.1350740e+04],
       [1.0000000e+00, 2.9866580e+04],
       [1.0000000e+00, 3.2485550e+04],
       [1.0000000e+00, 2.7195200e+04],
       [1.0000000e+00, 1.0199409e+05],
       [1.0000000e+00, 9.0092800e+03],
       [1.0000000e+00, 4.3603120e+04],
       [1.0000000e+00, 3.7044890e+04],
       [1.0000000e+00, 7.4822110e+04],
       [1.0000000e+00, 1.2495330e+04],
       [1.0000000e+00, 1.9121590e+04],
       [1.0000000e+00, 1.5991740e+04],
       [1.0000000e+00, 2.5864720e+04],
       [1.0000000e+00, 4.9866270e+04],
       [1.0000000e+00, 8.0675310e+04],
       [1.0000000e+00, 9.4373700e+03],
       [1.0000000e+00, 4.3770690e+04],
       [1.0000000e+00, 5.5805200e+04],
       [1.0000000e+00, 8.6700000e+03],
       [1.0000000e+00, 1.3340910e+04],
       [1.0000000e+00, 1.7288080e+04],
       [1.0000000e+00, 3.5343340e+04],
       [1.0000000e+00, 1.3618570e+04],
       [1.0000000e+00, 9.0549100e+03],
       [1.0000000e+00, 2.0732480e+04],
       [1.0000000e+00, 5.6945700e+03],
       [1.0000000e+00, 6.0835100e+03],
       [1.0000000e+00, 1.4210280e+04]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_b</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(40, 2)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div style="border:1px solid black; padding:10px">

<font color="blue">Note:</font><br>
 - 40 is the number of GDPs, this did not change
 - 2 is the number of 'columns' in this X_b 2d array, the 1st column is the 1 we added used np.ones(), and the other value is the GDP

</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr style="border-top: 2px solid black;">
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Step-2:-Create-a-new-Matrix-X_b_transposed-by-transposing-X_b">Step 2: Create a new Matrix <code>X_b_transposed</code> by transposing <code>X_b</code><a class="anchor-link" href="#Step-2:-Create-a-new-Matrix-X_b_transposed-by-transposing-X_b">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Matrix-transpose-using-numpy-.T-attribute.">Matrix transpose using numpy .T attribute.<a class="anchor-link" href="#Matrix-transpose-using-numpy-.T-attribute.">&#182;</a></h2><ul>
<li>Documentation as of 5/15/20: <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.T.html">https://numpy.org/devdocs/reference/generated/numpy.ndarray.T.html</a></li>
</ul>
<h2 id="Matrix-transpose-Example">Matrix transpose Example<a class="anchor-link" href="#Matrix-transpose-Example">&#182;</a></h2><p>The transpose of a matrix $M$ is a matrix noted $M^T$ such that the $i^{th}$ row in $M^T$ is equal to the $i^{th}$ column in $M$:</p>
<p>$ Xb^T =
\begin{bmatrix}
  1 &amp; 5.09 \\
  1 &amp; 4.37 
\end{bmatrix}^T =
\begin{bmatrix}
  1 &amp; 1 \\
  5.09 &amp; 4.37
\end{bmatrix}$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_b_transposed</span> <span class="o">=</span> <span class="n">X_b</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Inspect-transposition">Inspect transposition<a class="anchor-link" href="#Inspect-transposition">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_b_transposed</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[1.0000000e+00, 1.0000000e+00, 1.0000000e+00, 1.0000000e+00,
        1.0000000e+00, 1.0000000e+00, 1.0000000e+00, 1.0000000e+00,
        1.0000000e+00, 1.0000000e+00, 1.0000000e+00, 1.0000000e+00,
        1.0000000e+00, 1.0000000e+00, 1.0000000e+00, 1.0000000e+00,
        1.0000000e+00, 1.0000000e+00, 1.0000000e+00, 1.0000000e+00,
        1.0000000e+00, 1.0000000e+00, 1.0000000e+00, 1.0000000e+00,
        1.0000000e+00, 1.0000000e+00, 1.0000000e+00, 1.0000000e+00,
        1.0000000e+00, 1.0000000e+00, 1.0000000e+00, 1.0000000e+00,
        1.0000000e+00, 1.0000000e+00, 1.0000000e+00, 1.0000000e+00,
        1.0000000e+00, 1.0000000e+00, 1.0000000e+00, 1.0000000e+00],
       [5.0961870e+04, 4.3724030e+04, 4.0106630e+04, 4.3331960e+04,
        1.7256920e+04, 5.2114170e+04, 4.1973990e+04, 3.7675010e+04,
        4.0996510e+04, 1.8064290e+04, 1.2239890e+04, 5.0854580e+04,
        5.1350740e+04, 2.9866580e+04, 3.2485550e+04, 2.7195200e+04,
        1.0199409e+05, 9.0092800e+03, 4.3603120e+04, 3.7044890e+04,
        7.4822110e+04, 1.2495330e+04, 1.9121590e+04, 1.5991740e+04,
        2.5864720e+04, 4.9866270e+04, 8.0675310e+04, 9.4373700e+03,
        4.3770690e+04, 5.5805200e+04, 8.6700000e+03, 1.3340910e+04,
        1.7288080e+04, 3.5343340e+04, 1.3618570e+04, 9.0549100e+03,
        2.0732480e+04, 5.6945700e+03, 6.0835100e+03, 1.4210280e+04]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_b_transposed</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2, 40)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div style="border:1px solid black; padding:10px">

<font color="blue">Note:</font><br>
 - The X<code>X_b</code>b had a shape of (40, 2)
 - The transposed <code>X_b_transposed</code> has a shape of (2, 40), so now there are two 'rows' and 40 'instances'
 - The 1's have been 'separated' from the GPD data in this 2D transpossed array

</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr style="border-top: 2px solid black;">
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Step-3:-Create-a-new-Matrix-mm-by-Multiplying-the-transposed-maxtrix--X_b_transposed-by-X_b">Step 3: Create a new Matrix <code>mm</code> by Multiplying the transposed maxtrix  <code>X_b_transposed</code> by <code>X_b</code><a class="anchor-link" href="#Step-3:-Create-a-new-Matrix-mm-by-Multiplying-the-transposed-maxtrix--X_b_transposed-by-X_b">&#182;</a></h1><ul>
<li>Use the dot product (scalar product) of two vectors approach</li>
<li>Documentation as of 5/15/20: <a href="https://numpy.org/devdocs/reference/generated/numpy.dot.html">https://numpy.org/devdocs/reference/generated/numpy.dot.html</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Matrix multiplication (mm)</span>
<span class="n">mm</span> <span class="o">=</span> <span class="n">X_b_transposed</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_b</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Print values of mm</span>
<span class="n">mm</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[4.00000000e+01, 1.31373628e+06],
       [1.31373628e+06, 6.19433521e+10]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mm</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2, 2)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div style="border:1px solid black; padding:10px">

<font color="blue">Note:</font><br>
 - <code>mm</code> is now 2 by 2
 - Matrix multiplication will reduce the matrix shape

</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr style="border-top: 2px solid black;">
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Step-4:-Compute-the-inverse-of-the-matrix-using-np.linalg.inv(a)">Step 4: Compute the inverse of the matrix using <code>np.linalg.inv(a)</code><a class="anchor-link" href="#Step-4:-Compute-the-inverse-of-the-matrix-using-np.linalg.inv(a)">&#182;</a></h1><ul>
<li>Compute the (multiplicative) inverse of a matrix.</li>
<li>Documentation as of 5/15/20: <a href="https://numpy.org/doc/1.18/reference/generated/numpy.linalg.inv.html">https://numpy.org/doc/1.18/reference/generated/numpy.linalg.inv.html</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inv_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Print output</span>
<span class="n">inv_matrix</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[ 8.23899871e-02, -1.74738227e-06],
       [-1.74738227e-06,  5.32034411e-11]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr style="border-top: 2px solid black;">
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Step-5:-Calculate-Theta_best-by-multiplying-the-inverse-matrix-X_b.T-to-the-predictor-vector-y-using-the-.dot()-method">Step 5: Calculate Theta_best by multiplying the inverse matrix <code>X_b.T</code> to the predictor vector <code>y</code> using the <code>.dot()</code> method<a class="anchor-link" href="#Step-5:-Calculate-Theta_best-by-multiplying-the-inverse-matrix-X_b.T-to-the-predictor-vector-y-using-the-.dot()-method">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theta_best</span> <span class="o">=</span> <span class="n">inv_matrix</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_b</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theta_best</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[5.72408174e+00],
       [2.46904428e-05]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">intercept</span><span class="p">,</span> <span class="n">line_coef</span> <span class="o">=</span> <span class="n">theta_best</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">theta_best</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The intercept for the normal equation is </span><span class="si">{}</span><span class="s1">, </span><span class="se">\n</span><span class="s1">and the coefficient is: </span><span class="si">{}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span> <span class="n">line_coef</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>The intercept for the normal equation is [5.72408174], 
and the coefficient is: [2.46904428e-05] 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr style="border-top: 2px solid black;">
</div>
</div>
</div>
 

