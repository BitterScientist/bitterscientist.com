<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Import-dependencies">Import dependencies<a class="anchor-link" href="#Import-dependencies">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">PyPDF2</span> <span class="k">import</span> <span class="n">PdfFileReader</span><span class="p">,</span> <span class="n">PdfFileWriter</span>

<span class="c1"># load data</span>
<span class="o">%</span><span class="k">store</span> -r labels

<span class="kn">import</span> <span class="nn">nbimporter</span>
<span class="kn">from</span> <span class="nn">pypdf2_split_part1</span> <span class="k">import</span> <span class="n">split_pdf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Importing Jupyter notebook from pypdf2_split_part1.ipynb
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr style="border-top: 2px solid black;">
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Function-Explanation"><font color="blue">Function Explanation</font><a class="anchor-link" href="#Function-Explanation">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Line 1</font></strong>
<strong>Code</strong><code>def split_pdf(path, labels):</code><br><br>
<strong>What it does:</strong>
Creates function that will take in two parameters:</p>
<ul>
<li>file path</li>
<li>list of label</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Line 2</font></strong>
<strong>Code:</strong><code> fname = os.path.splitext(os.path.basename(path))[0]</code><br><br>
<strong>What it does:</strong> It returns the file name of the pdf file that will be split<br>
<strong>How?</strong></p>
<ul>
<li>The <code>os</code> module provides a portable way of using operating system dependent functionality.
<strong>Bottomline:</strong><br>
The filename is obtained</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;File.pdf&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>First: Get the file name</strong></p>
<ul>
<li>The <code>os.path.basename(path)</code> returns the basename of the file</li>
<li><code>[0]</code> will return just the name of the input file and ignore the extension.<br></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;File.pdf&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Second: Split the file name</strong></p>
<ul>
<li>The <code>os.path</code> is a submodule used for pathname manipulation</li>
<li>The <code>os.path.splitext()</code> method is used to split the path name into a pair root and extention.</li>
<li>This will return a tuple (file name, extention)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
<span class="n">fname</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(&#39;File&#39;, &#39;.pdf&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Third: Extract only the filename</strong></p>
<ul>
<li><code>os.path.splitext()</code> will return a tuple: (file name, extention)</li>
<li><code>os.path.splitext()[0]</code> will return the first element in the tuple, the file name.<br></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">fname</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;File&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Line 3</font></strong>
<strong>Code:</strong><code> pdf = PdfFileReader(path)</code><br><br>
<strong>What it does:</strong> creates a reader object of the pdf file we will split<br></p>
<ul>
<li>Documentation: <a href="https://pythonhosted.org/PyPDF2/PdfFileReader.html">https://pythonhosted.org/PyPDF2/PdfFileReader.html</a> </li>
<li>You can then apply these methods</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pdf</span> <span class="o">=</span> <span class="n">PdfFileReader</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">pdf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;PyPDF2.pdf.PdfFileReader at 0x112a1ec50&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Line 4</font></strong>: Inside the for loop
<br>
<strong>Code:</strong><code> for page, label in zip(range(pdf.getNumPages()), labels):</code><br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>range(pdf.getNumPages())</code> returns the range of the number pages in the pdf</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">range</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">getNumPages</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>range(0, 25)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>zip(range(pdf.getNumPages()), labels)</code> The zip() function takes iterables (the range of pages in the pdf and the list of labels), and aggregates them in a tuple, and return it.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">getNumPages</span><span class="p">()),</span> <span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;zip at 0x111c93af0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>for page, label in zip(range(pdf.getNumPages()), labels):</code><br></li>
<li>since <code>zip()</code> is used, the for loop will require two indexes <ul>
<li>1) page will be in the index in the range of pages in the pdf file</li>
<li>2) label will be the index for the labels list</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">page</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">getNumPages</span><span class="p">()),</span> <span class="n">labels</span><span class="p">):</span>
<span class="c1"># Printing this just for illustration</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0 a
1 b
2 c
3 d
4 e
5 f
6 g
7 h
8 i
9 j
10 k
11 l
12 m
13 n
14 o
15 p
16 q
17 r
18 s
19 t
20 u
21 v
22 w
23 x
24 y
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Line 5</font></strong>: Inside the for loop
<strong>Code:</strong><code>pdf_writer = PdfFileWriter()</code><br><br>
<strong>What it does:</strong> creates an instance of the PdfFileWriter<br></p>
<ul>
<li>Documentation: <a href="https://pythonhosted.org/PyPDF2/PdfFileWriter.html">https://pythonhosted.org/PyPDF2/PdfFileWriter.html</a></li>
<li>This class supports writing PDF files out. In other words, to save each page we are splitting.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pdf_writer</span> <span class="o">=</span> <span class="n">PdfFileWriter</span><span class="p">()</span>
<span class="n">pdf_writer</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;PyPDF2.pdf.PdfFileWriter at 0x112cd0b10&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Line 6</font></strong>: Inside the for loop
<strong>Code:</strong><code>pdf_writer.addPage(pdf.getPage(page))</code><br><br>
<strong>What it does:</strong>Gets the current page of the pdf file that will be split, and then saves taht information into a new pdf file object<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Line 7</font></strong>: Inside the for loop
<strong>Code:</strong><code>output_filename = '{}_{}.pdf'.format(fname, label)</code><br></p>
<ul>
<li><strong>What it does:</strong> Creates a unique file name that will be used as the new file name when the file is saved.<br></li>
<li><code>fname</code>: value saved from <font color="red">Line 1</font></li>
<li><code>label</code>: is the unique label from the list of labels</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Example: fname as &#39;File&#39; and &#39;a&#39; as the unique label</span>
<span class="c1"># the {}_{} will be replaced with the values in the .format() arguments</span>
<span class="n">output_filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.pdf&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;File&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">output_filename</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;File_a.pdf&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Line 8-9</font></strong>: Inside the for loop<br></p>
<p><strong>Code:</strong><br>
<code>with open(output_filename, 'wb') as out:
    pdf_writer.write(out)</code><br></p>
<ul>
<li><strong>What it does:</strong> open the new file name in write-binary mode and use the PDF writer object’s write method to write the object’s contents to disk.<br></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><font color="red">Line 10</font></strong>: Inside the for loop
<strong>Code:</strong><code>print('Created: {}'.format(output_filename))</code><br></p>
<ul>
<li><strong>What it does:</strong> print out the file that has been saved, so you can track the progress of your file splitting.<br></li>
</ul>

</div>
</div>
</div>
 

