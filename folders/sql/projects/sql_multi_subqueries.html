<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Goal:--Determine-if-the-average-number-of-goals-scored-changes-with-each-stage-in-the-2015/2016-season."><font color="blue">Goal: </font> Determine if the average number of goals scored changes with each stage in the 2015/2016 season.<a class="anchor-link" href="#Goal:--Determine-if-the-average-number-of-goals-scored-changes-with-each-stage-in-the-2015/2016-season.">&#182;</a></h1><h1 id="Method:--Use-subqueries-in-the-SELECT,-FROM,--and-WHERE-clauses."><font color="blue">Method: </font> Use subqueries in the <code>SELECT</code>, <code>FROM</code>,  and <code>WHERE</code> clauses.<a class="anchor-link" href="#Method:--Use-subqueries-in-the-SELECT,-FROM,--and-WHERE-clauses.">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Import-Dependencies">Import Dependencies<a class="anchor-link" href="#Import-Dependencies">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">create_engine</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># For data vis and post sql data wranging</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Connect to sqlite database</span>
<span class="c1"># engine = create_engine(&quot;sqlite:////filepath/soccer.sqlite&quot;, echo=False)</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Confirm connection by printing tables</span>
<span class="n">engine</span><span class="o">.</span><span class="n">table_names</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;Country&#39;,
 &#39;League&#39;,
 &#39;Match&#39;,
 &#39;Player&#39;,
 &#39;Player_Attributes&#39;,
 &#39;Team&#39;,
 &#39;Team_Attributes&#39;,
 &#39;sqlite_sequence&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Examine-Data">Examine Data<a class="anchor-link" href="#Examine-Data">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_view1</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM Match LIMIT 3;&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Run query</span>
<span class="n">view_data1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_view1</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="c1"># Displaying data</span>
<span class="n">view_data1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>country_id</th>
      <th>league_id</th>
      <th>season</th>
      <th>stage</th>
      <th>date</th>
      <th>match_api_id</th>
      <th>home_team_api_id</th>
      <th>away_team_api_id</th>
      <th>home_team_goal</th>
      <th>away_team_goal</th>
      <th>home_player_X1</th>
      <th>home_player_X2</th>
      <th>home_player_X3</th>
      <th>home_player_X4</th>
      <th>home_player_X5</th>
      <th>home_player_X6</th>
      <th>home_player_X7</th>
      <th>home_player_X8</th>
      <th>home_player_X9</th>
      <th>home_player_X10</th>
      <th>home_player_X11</th>
      <th>away_player_X1</th>
      <th>away_player_X2</th>
      <th>away_player_X3</th>
      <th>away_player_X4</th>
      <th>away_player_X5</th>
      <th>away_player_X6</th>
      <th>away_player_X7</th>
      <th>away_player_X8</th>
      <th>away_player_X9</th>
      <th>away_player_X10</th>
      <th>away_player_X11</th>
      <th>home_player_Y1</th>
      <th>home_player_Y2</th>
      <th>home_player_Y3</th>
      <th>home_player_Y4</th>
      <th>home_player_Y5</th>
      <th>home_player_Y6</th>
      <th>home_player_Y7</th>
      <th>home_player_Y8</th>
      <th>home_player_Y9</th>
      <th>home_player_Y10</th>
      <th>home_player_Y11</th>
      <th>away_player_Y1</th>
      <th>away_player_Y2</th>
      <th>away_player_Y3</th>
      <th>away_player_Y4</th>
      <th>away_player_Y5</th>
      <th>away_player_Y6</th>
      <th>away_player_Y7</th>
      <th>away_player_Y8</th>
      <th>away_player_Y9</th>
      <th>away_player_Y10</th>
      <th>away_player_Y11</th>
      <th>home_player_1</th>
      <th>home_player_2</th>
      <th>home_player_3</th>
      <th>home_player_4</th>
      <th>home_player_5</th>
      <th>home_player_6</th>
      <th>home_player_7</th>
      <th>home_player_8</th>
      <th>home_player_9</th>
      <th>home_player_10</th>
      <th>home_player_11</th>
      <th>away_player_1</th>
      <th>away_player_2</th>
      <th>away_player_3</th>
      <th>away_player_4</th>
      <th>away_player_5</th>
      <th>away_player_6</th>
      <th>away_player_7</th>
      <th>away_player_8</th>
      <th>away_player_9</th>
      <th>away_player_10</th>
      <th>away_player_11</th>
      <th>goal</th>
      <th>shoton</th>
      <th>shotoff</th>
      <th>foulcommit</th>
      <th>card</th>
      <th>cross</th>
      <th>corner</th>
      <th>possession</th>
      <th>B365H</th>
      <th>B365D</th>
      <th>B365A</th>
      <th>BWH</th>
      <th>BWD</th>
      <th>BWA</th>
      <th>IWH</th>
      <th>IWD</th>
      <th>IWA</th>
      <th>LBH</th>
      <th>LBD</th>
      <th>LBA</th>
      <th>PSH</th>
      <th>PSD</th>
      <th>PSA</th>
      <th>WHH</th>
      <th>WHD</th>
      <th>WHA</th>
      <th>SJH</th>
      <th>SJD</th>
      <th>SJA</th>
      <th>VCH</th>
      <th>VCD</th>
      <th>VCA</th>
      <th>GBH</th>
      <th>GBD</th>
      <th>GBA</th>
      <th>BSH</th>
      <th>BSD</th>
      <th>BSA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-17 00:00:00</td>
      <td>492473</td>
      <td>9987</td>
      <td>9993</td>
      <td>1</td>
      <td>1</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.73</td>
      <td>3.4</td>
      <td>5.00</td>
      <td>1.75</td>
      <td>3.35</td>
      <td>4.20</td>
      <td>1.85</td>
      <td>3.2</td>
      <td>3.5</td>
      <td>1.8</td>
      <td>3.3</td>
      <td>3.75</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.70</td>
      <td>3.30</td>
      <td>4.33</td>
      <td>1.90</td>
      <td>3.3</td>
      <td>4.0</td>
      <td>1.65</td>
      <td>3.40</td>
      <td>4.50</td>
      <td>1.78</td>
      <td>3.25</td>
      <td>4.00</td>
      <td>1.73</td>
      <td>3.40</td>
      <td>4.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492474</td>
      <td>10000</td>
      <td>9994</td>
      <td>0</td>
      <td>0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.95</td>
      <td>3.2</td>
      <td>3.60</td>
      <td>1.80</td>
      <td>3.30</td>
      <td>3.95</td>
      <td>1.90</td>
      <td>3.2</td>
      <td>3.5</td>
      <td>1.9</td>
      <td>3.2</td>
      <td>3.50</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>1.83</td>
      <td>3.30</td>
      <td>3.60</td>
      <td>1.95</td>
      <td>3.3</td>
      <td>3.8</td>
      <td>2.00</td>
      <td>3.25</td>
      <td>3.25</td>
      <td>1.85</td>
      <td>3.25</td>
      <td>3.75</td>
      <td>1.91</td>
      <td>3.25</td>
      <td>3.60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2008/2009</td>
      <td>1</td>
      <td>2008-08-16 00:00:00</td>
      <td>492475</td>
      <td>9984</td>
      <td>8635</td>
      <td>0</td>
      <td>3</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.38</td>
      <td>3.3</td>
      <td>2.75</td>
      <td>2.40</td>
      <td>3.30</td>
      <td>2.55</td>
      <td>2.60</td>
      <td>3.1</td>
      <td>2.3</td>
      <td>2.5</td>
      <td>3.2</td>
      <td>2.50</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>2.50</td>
      <td>3.25</td>
      <td>2.40</td>
      <td>2.63</td>
      <td>3.3</td>
      <td>2.5</td>
      <td>2.35</td>
      <td>3.25</td>
      <td>2.65</td>
      <td>2.50</td>
      <td>3.20</td>
      <td>2.50</td>
      <td>2.30</td>
      <td>3.20</td>
      <td>2.75</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Step-1:-Add-subquery-in-the-SELECT-Clause">Step 1: Add subquery in the <code><font color="red">SELECT</font></code> Clause<a class="anchor-link" href="#Step-1:-Add-subquery-in-the-SELECT-Clause">&#182;</a></h1><ul>
<li>Average Goals: Extract the average home and away goals</li>
<li>Average Goal for each stage: Calculate the average home and away goals by stage</li>
<li>Filter both queries for the 2015/2016 season.</li>
<li>A filter in the select clause will return a column with a scalar value!</li>
<li><b>Most of the work will be done in the <code>SELECT</code> clause.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_view2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;SELECT </span>
<span class="s2">    m.stage,</span>
<span class="s2">    ROUND(AVG(m.home_team_goal + m.away_team_goal),2) AS avg_goals,</span>
<span class="s2">    ROUND((SELECT AVG(home_team_goal + away_team_goal) </span>
<span class="s2">           FROM Match </span>
<span class="s2">           WHERE season = &#39;2015/2016&#39;),2) AS overall</span>
<span class="s2">FROM Match AS m</span>
<span class="s2">WHERE season = &#39;2015/2016&#39;</span>
<span class="s2">GROUP BY m.stage;&quot;&quot;&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Run query</span>
<span class="n">view_data2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_view2</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="c1"># Displaying data</span>
<span class="n">view_data2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stage</th>
      <th>avg_goals</th>
      <th>overall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2.70</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2.44</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>2.46</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>2.71</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>2.60</td>
      <td>2.75</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3><font color="blue"><code>SELECT</code> Clause Explained:</font><br></h3>
<p><strong>The <code>SELECT</code> clause.</strong><br></p>
<ul>
<li>Will return 3 columns of records</li>
<li>Contains a subquery<br></li>
<li>The subquery will return a scalar value (meaning it will be the same value in the column)</li>
</ul>
<p><code>SELECT 
    m.stage,
    ROUND(AVG(m.home_team_goal + m.away_team_goal),2) AS avg_goals,
    ROUND((SELECT AVG(home_team_goal + away_team_goal) 
           FROM Match 
           WHERE season = '2015/2016'),2) AS overall</code>
<br><br>
The <code>SELECT</code><br> Clause:
This will instruct the query to return the following columns<br></p>
<ul>
<li>Column 1: <code>m.stage</code><br><ul>
<li>The stage column from the Match table</li>
</ul>
</li>
<li><p>Column 2: <code>ROUND(AVG(m.home_team_goal + m.away_team_goal),2) AS avg_goals</code></p>
<ul>
<li>This is a calculated field, and will return the rounded average of total goals scores from the match column</li>
<li><code>AS avg_goals</code><ul>
<li>This will alias the records so that the column has the title "avg_goals"</li>
</ul>
</li>
</ul>
</li>
<li><p>Column 3: <code>(ROUND((SELECT AVG(home_team_goal + away_team_goal) FROM Match WHERE season = '2015/2016'),2) AS overall</code></p>
<ul>
<li>This is a subquery that will return a column with the overall average goals scores</li>
<li>The value will be the same for all rows in the column</li>
<li>The results from this subquery will be alias as <code><b>overall_avg</b></code> and will be the title of the column </li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3><font color="blue"><code>FROM</code> Clause Explained:</font><br></h3>
<p><strong>The <code>FROM</code> clause.</strong><br>
<code>FROM Match AS m</code>
<br>
<code>FROM</code><br>
Is the source of the data that will be used<br></p>
<ul>
<li>The dataset will be obtained from the Match table as is aliased as <code><b>m</b></code> for ease</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3><font color="blue"><code>WHERE</code> Clause Explained:</font><br></h3>
<p><strong>The <code>WHERE</code> clause.</strong><br>
<code>WHERE season = '2015/2016'</code>
<br>
<code>WHERE</code><br>
This will instruct the query to filter the rows of data if they meet a specific criteria<br></p>
<ul>
<li>The data will be filtered for records where the season is 2015/2016</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Taken-Together">Taken Together<a class="anchor-link" href="#Taken-Together">&#182;</a></h2><p>This code will use the <code>SELECT</code> clause to display the records provided by the <code>FROM</code> clause.</p>
<ul>
<li>The <code>FROM</code> clause will prepare the data that will be eventualy displayed from the Match table.</li>
<li>The <code>SELECT</code> clause will return a set of records.<ul>
<li>This includes the three columns: the stage and the avg_goals the overall average goals using a the subquery</li>
<li>The column labels are given here with the aliases for two of the columns</li>
</ul>
</li>
<li>The <code>WHERE</code> clause will instruct which records are to be displayed.<ul>
<li>This will limit the records to those where the season is 2015/2016.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualize-average-goals-for-the-38-stages-and-identify-those-stages-that-are-greater-than-the-overall-goals-for-the-2015/2016-season.">Visualize average goals for the 38 stages and identify those stages that are greater than the overall goals for the 2015/2016 season.<a class="anchor-link" href="#Visualize-average-goals-for-the-38-stages-and-identify-those-stages-that-are-greater-than-the-overall-goals-for-the-2015/2016-season.">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Prepare-data-for-plotting">Prepare data for plotting<a class="anchor-link" href="#Prepare-data-for-plotting">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This is the stages array</span>
<span class="n">stages</span> <span class="o">=</span> <span class="n">view_data2</span><span class="o">.</span><span class="n">stage</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># These are the average goal per stage</span>
<span class="n">avg_goals</span> <span class="o">=</span> <span class="n">view_data2</span><span class="o">.</span><span class="n">avg_goals</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># This is an array that contains the overall average number of goals scored for the entire season</span>
<span class="n">overall</span> <span class="o">=</span>  <span class="n">view_data2</span><span class="o">.</span><span class="n">overall</span><span class="o">.</span><span class="n">values</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Prepare-color-arrangement">Prepare color arrangement<a class="anchor-link" href="#Prepare-color-arrangement">&#182;</a></h3><p>The bar chart will color code stages with average goals scores greater than the overall average</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a boolean array that marks stages with greater average goals than the overall</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">avg_goals</span> <span class="o">&gt;</span> <span class="n">overall</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This creates an array of colors that are by default bloe</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;b&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">avg_goals</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This will change elements of the color array to red if that corresponds to a </span>
<span class="c1"># season where the average scores are greater than the overall average</span>
<span class="n">colors</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Create-plot">Create plot<a class="anchor-link" href="#Create-plot">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">avg_goals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">overall</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">stages</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Average Goals&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Stages&quot;</span><span class="p">)</span>
<span class="c1"># plt.savefig(&quot;filepath/filename.format&quot;, bbox_inches=&#39;tight&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Observation:">Observation:<a class="anchor-link" href="#Observation:">&#182;</a></h3><p>The number of stages with average scores greater than the overall average appears to increase in frequency as the season progresses.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Step-2:-Add-subquery-in-FROM-Clause">Step 2: Add subquery in <code><font color="red">FROM</font></code> Clause<a class="anchor-link" href="#Step-2:-Add-subquery-in-FROM-Clause">&#182;</a></h1><p>This step will turn the main query into a subquery and filter out a list of stages where the average goals in a stage is greater than the overall average goals in a match.<br></p>
<ul>
<li><code>FROM</code> clause subquery: Calculate the average goals for each stage in the FROM clause subquery.</li>
<li><code>WHERE</code> clause subquery: Calculate the overall average goals scored</li>
<li>Filter the main query for stages where the average goals &gt; than the overall average.</li>
<li><code>SELECT</code> clause: Select the stage and avg_goals columns from the s subquery into the main query.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_view3</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT </span>
<span class="s2">    subquery.stage,</span>
<span class="s2">    ROUND(subquery.avg_goals,2) AS avg_goals</span>
<span class="s2">FROM </span>
<span class="s2">    (</span>
<span class="s2">    SELECT</span>
<span class="s2">        stage,</span>
<span class="s2">        AVG(home_team_goal + away_team_goal) AS avg_goals</span>
<span class="s2">    FROM Match</span>
<span class="s2">    WHERE season = &#39;2015/2016&#39;</span>
<span class="s2">    GROUP BY stage) AS subquery</span>
<span class="s2">WHERE </span>
<span class="s2">    subquery.avg_goals &gt; (SELECT AVG(home_team_goal + away_team_goal) </span>
<span class="s2">                    FROM match WHERE season = &#39;2015/2016&#39;);&quot;&quot;&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Run query</span>
<span class="n">view_data3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_view3</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="c1"># Displaying data</span>
<span class="n">view_data3</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[14]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stage</th>
      <th>avg_goals</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>2.81</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8</td>
      <td>3.05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13</td>
      <td>3.02</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17</td>
      <td>3.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18</td>
      <td>2.82</td>
    </tr>
    <tr>
      <th>5</th>
      <td>20</td>
      <td>2.98</td>
    </tr>
    <tr>
      <th>6</th>
      <td>21</td>
      <td>2.94</td>
    </tr>
    <tr>
      <th>7</th>
      <td>22</td>
      <td>2.81</td>
    </tr>
    <tr>
      <th>8</th>
      <td>23</td>
      <td>2.90</td>
    </tr>
    <tr>
      <th>9</th>
      <td>26</td>
      <td>2.97</td>
    </tr>
    <tr>
      <th>10</th>
      <td>27</td>
      <td>2.82</td>
    </tr>
    <tr>
      <th>11</th>
      <td>28</td>
      <td>3.03</td>
    </tr>
    <tr>
      <th>12</th>
      <td>31</td>
      <td>2.76</td>
    </tr>
    <tr>
      <th>13</th>
      <td>33</td>
      <td>2.81</td>
    </tr>
    <tr>
      <th>14</th>
      <td>34</td>
      <td>3.04</td>
    </tr>
    <tr>
      <th>15</th>
      <td>35</td>
      <td>3.02</td>
    </tr>
    <tr>
      <th>16</th>
      <td>38</td>
      <td>3.52</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3><font color="blue">INNER Subquery Explained:</font><br></h3>
<p><strong>The INNER Subquery in the <code>FROM</code> clause.</strong><br>
<code>FROM 
    (
    SELECT
        stage,
        AVG(home_team_goal + away_team_goal) AS avg_goals
    FROM Match
    WHERE season = '2015/2016'
    GROUP BY stage
    ) AS subquery</code>
<br><br></p>
<p><code>FROM</code> Clause<br>
This will instruct where the data will be obtained<br><br>
<code>(SELECT stage, AVG(home_team_goal + away_team_goal) AS avg_goals FROM Match</code><br>
This subquery selects data from two columns:<br>
the stage column<br>
a calculated field that averages out the home and away goals and aslias that as <code>avg_goals</code> <br><br>
<code>WHERE season = '2015/2016'GROUP BY stage) AS subquery</code><br>
This WHERE clause filters the whole dataset so that only the season 2015/2016 is returned.<br>
the <code> AS subquery</code> code will alias the subquery so that it is easily references in the mail query.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3><font color="blue"><code>SELECT</code> Clause Explained:</font><br></h3>
<p><strong>The <code>SELECT</code> clause.</strong><br>
<code>SELECT 
    subquery.stage,
    ROUND(subquery.avg_goals,2) AS avg_goals</code>
<br>
<code>SELECT</code><br>
This will instruct the query to select the following columns<br>
<code>subquery.stage</code><br>
<code>ROUND(subquery.avg_goals,2) AS avg_goals</code><br>
<code>ROUND()</code> will format the decimal places to the 100th place</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3><font color="blue"><code>WHERE</code> Clause Explained:</font><br></h3>
<p><strong>The <code>WHERE</code> clause.</strong><br>
<code>WHERE 
    subquery.avg_goals > (SELECT AVG(home_team_goal + away_team_goal) 
                    FROM match WHERE season = '2015/2016');</code>
<br>
<code>WHERE</code><br>
This will instruct the query to filter the rows of data if they meet a specific criteria<br>
<code>subquery.avg_goals > (SELECT AVG(home_team_goal + away_team_goal) 
                    FROM match WHERE season = '2015/2016')</code><br>
The WHERE clause will filter data by checking rows in the subquery.avg_goals column<br>
And will return those rows if they are greater than the subquery:<br>
<code>(SELECT AVG(home_team_goal + away_team_goal) FROM match WHERE season = '2015/2016')</code>
This subquery returns a single value, the overall average goals scores in the 2015/2016 season.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Taken-Together">Taken Together<a class="anchor-link" href="#Taken-Together">&#182;</a></h2><ul>
<li>The <code>FROM</code> clause will prepare the data that will be eventualy displayed.<ul>
<li>This is the the subquery</li>
</ul>
</li>
<li>The <code>SELECT</code> clause will return a set of records.<ul>
<li>This includes the two columns stage and avg_goals from the subquery</li>
</ul>
</li>
<li>The <code>WHERE</code> clause will instruct which records are to be displayed.<ul>
<li>This would be records where the subquery average goals is greater than the overall goals</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualize-the-results-from-this-SQL-statement-with-the-subqueries-in-the-FROM-clause-for-the-2015/2016-season.">Visualize the results from this SQL statement with the subqueries in the <code>FROM</code> clause for the 2015/2016 season.<a class="anchor-link" href="#Visualize-the-results-from-this-SQL-statement-with-the-subqueries-in-the-FROM-clause-for-the-2015/2016-season.">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This is the stages array</span>
<span class="n">stages</span> <span class="o">=</span> <span class="n">view_data3</span><span class="o">.</span><span class="n">stage</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># These are the average goal per stage</span>
<span class="n">avg_goals</span> <span class="o">=</span> <span class="n">view_data3</span><span class="o">.</span><span class="n">avg_goals</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># This is an array that contains the overall average number of goals scored for the entire season</span>
<span class="n">overall</span> <span class="o">=</span>  <span class="n">view_data2</span><span class="o">.</span><span class="n">overall</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a boolean array that marks stages with greater average goals than the overall</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">avg_goals</span> <span class="o">&gt;</span> <span class="n">overall</span>
<span class="c1"># This creates an array of colors that are by default bloe</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;b&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">avg_goals</span><span class="p">))</span>
<span class="c1"># This will change elements of the color array to red if that corresponds to a </span>
<span class="c1"># season where the average scores are greater than the overall average</span>
<span class="n">colors</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Create-plot">Create plot<a class="anchor-link" href="#Create-plot">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">avg_goals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">overall</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">stages</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Average Goals&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Stages&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span>
<span class="c1"># plt.savefig(&quot;filepath/filename.format&quot;, bbox_inches=&#39;tight&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Observation:">Observation:<a class="anchor-link" href="#Observation:">&#182;</a></h3><p>This query retrieved the same data as in step 1, although it filtered out the stages that did not meet the threshold. This plot demonstrates that these stages were filtered out.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Step-3:-Add-a-subquery-in-the-SELECT-Clause">Step 3: Add a subquery in the <code><font color="red">SELECT</font></code> Clause<a class="anchor-link" href="#Step-3:-Add-a-subquery-in-the-SELECT-Clause">&#182;</a></h1><p>This step will create a query that will compare the average number of goals scored in each stage to the total.<br>
It will do the same as in step 2, <b>BUT</b> will add an additional column with the overall average goals scored in the 2015/2016 season.</p>
<ul>
<li><code>SELECT</code> clause subquery: returns a column "overall_avg" that yields the average goals scored in the 2015/2016 season.</li>
<li><code>FROM</code> clause subquery: calculates the average goals scored in each stage during the 2015/2016 season.</li>
<li>Finally, filter the main query for stages where the average goals &gt; than the overall average.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_view4</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT </span>
<span class="s2">    subquery.stage,</span>
<span class="s2">    ROUND(subquery.avg_goals,2) AS avg_goal,</span>
<span class="s2">    (</span>
<span class="s2">    SELECT AVG(home_team_goal + away_team_goal) </span>
<span class="s2">    FROM Match </span>
<span class="s2">    WHERE season = &#39;2015/2016&#39;</span>
<span class="s2">    ) AS overall_avg</span>
<span class="s2">FROM </span>
<span class="s2">    (</span>
<span class="s2">    SELECT</span>
<span class="s2">        stage,</span>
<span class="s2">        AVG(home_team_goal + away_team_goal) AS avg_goals</span>
<span class="s2">    FROM Match</span>
<span class="s2">    WHERE season = &#39;2015/2016&#39;</span>
<span class="s2">    GROUP BY stage) AS subquery</span>
<span class="s2">WHERE </span>
<span class="s2">    subquery.avg_goals &gt; (SELECT AVG(home_team_goal + away_team_goal) </span>
<span class="s2">                    FROM match WHERE season = &#39;2015/2016&#39;);</span>
<span class="s2">&quot;&quot;&quot;</span>                 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Run query</span>
<span class="n">view_data4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_view4</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="c1"># Displaying data</span>
<span class="n">view_data4</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[19]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stage</th>
      <th>avg_goal</th>
      <th>overall_avg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>2.81</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8</td>
      <td>3.05</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13</td>
      <td>3.02</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17</td>
      <td>3.00</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18</td>
      <td>2.82</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>5</th>
      <td>20</td>
      <td>2.98</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>6</th>
      <td>21</td>
      <td>2.94</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>7</th>
      <td>22</td>
      <td>2.81</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>8</th>
      <td>23</td>
      <td>2.90</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>9</th>
      <td>26</td>
      <td>2.97</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>10</th>
      <td>27</td>
      <td>2.82</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>11</th>
      <td>28</td>
      <td>3.03</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>12</th>
      <td>31</td>
      <td>2.76</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>13</th>
      <td>33</td>
      <td>2.81</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>14</th>
      <td>34</td>
      <td>3.04</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>15</th>
      <td>35</td>
      <td>3.02</td>
      <td>2.75466</td>
    </tr>
    <tr>
      <th>16</th>
      <td>38</td>
      <td>3.52</td>
      <td>2.75466</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Outcome-There-are-17-stages-with-average-scores-&gt;-than-the-overall-average-in-the-2015/2016-season"><font color="blue">The Outcome</font> There are 17 stages with average scores &gt; than the overall average in the 2015/2016 season<a class="anchor-link" href="#The-Outcome-There-are-17-stages-with-average-scores-&gt;-than-the-overall-average-in-the-2015/2016-season">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3><font color="blue">INNER Subquery Explained:</font><br></h3>
<p><strong>The INNER Subquery in the <code>FROM</code> clause.</strong><br>
<code>FROM 
    (
    SELECT
        stage,
        AVG(home_team_goal + away_team_goal) AS avg_goals
    FROM Match
    WHERE season = '2015/2016'
    GROUP BY stage) AS subquery</code>
<br><br></p>
<p><code>FROM</code> Clause<br>
This will instruct where the data will be obtained<br><br>
<code>(SELECT stage, AVG(home_team_goal + away_team_goal) AS avg_goals FROM Match</code><br>
This subquery selects data from two columns:<br>
the stage column<br>
a calculated field that averages out the home and away goals and aslias that as <code>avg_goals</code> <br><br>
<code>WHERE season = '2015/2016'GROUP BY stage) AS subquery</code><br>
This WHERE clause filters the whole dataset so that only the season 2015/2016 is returned.<br>
the <code> AS subquery</code> code will alias the subquery so that it is easily references in the mail query.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3><font color="blue"><code>SELECT</code> Clause Explained:</font><br></h3>
<p><strong>The <code>SELECT</code> clause.</strong><br>
<code>SELECT 
    subquery.stage,
    ROUND(subquery.avg_goals,2) AS avg_goal,
    (
    SELECT AVG(home_team_goal + away_team_goal) 
    FROM Match 
    WHERE season = '2015/2016'
    ) AS overall_avg</code>
<br><br>
The <code>SELECT</code><br> Clause:
This will instruct the query to return the following columns<br></p>
<ul>
<li>Column 1: <code>subquery.stage</code><br></li>
<li>Column 2: <code>ROUND(subquery.avg_goals,2) AS avg_goals</code><ul>
<li><code>ROUND()</code> will format the decimal places to the 100th place<br></li>
</ul>
</li>
<li>Column 3: <code>(
SELECT AVG(home_team_goal + away_team_goal) 
FROM Match 
WHERE season = '2015/2016'
) AS overall_avg</code><br><ul>
<li>This is a subquery that will return a column with the overall average goals scores</li>
<li>The results from this subquery is alias as <code><b>overall_avg</b></code></li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3><font color="blue"><code>WHERE</code> Clause Explained:</font><br></h3>
<p><strong>The <code>WHERE</code> clause.</strong><br>
<code>WHERE 
    subquery.avg_goals > (SELECT AVG(home_team_goal + away_team_goal) 
                    FROM match WHERE season = '2015/2016');</code>
<br>
<code>WHERE</code><br>
This will instruct the query to filter the rows of data if they meet a specific criteria<br>
<code>subquery.avg_goals > (SELECT AVG(home_team_goal + away_team_goal) 
                    FROM match WHERE season = '2015/2016')</code><br>
The WHERE clause will filter data by checking rows in the subquery.avg_goals column<br>
And will return those rows if they are greater than the subquery:<br>
<code>(SELECT AVG(home_team_goal + away_team_goal) FROM match WHERE season = '2015/2016')</code>
This subquery returns a single value, the overall average goals scores in the 2015/2016 season.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Taken-Together">Taken Together<a class="anchor-link" href="#Taken-Together">&#182;</a></h2><p>This code adds an additional statement in the <code>SELECT</code> clause (to add the overall average column)</p>
<ul>
<li>The <code>FROM</code> clause will prepare the data that will be eventualy displayed.<ul>
<li>This is the the subquery</li>
</ul>
</li>
<li>The <code>SELECT</code> clause will return a set of records.<ul>
<li>This includes the two columns stage and avg_goals from the subquery</li>
</ul>
</li>
<li>The <code>WHERE</code> clause will instruct which records are to be displayed.<ul>
<li>This would be records where the subquery average goals is greater than the overall goals</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Concluding-Remarks">Concluding Remarks<a class="anchor-link" href="#Concluding-Remarks">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Number-of-stages-with-average-goals-scores-were-greater-than-the-overall-average">Number of stages with average goals scores were greater than the overall average<a class="anchor-link" href="#Number-of-stages-with-average-goals-scores-were-greater-than-the-overall-average">&#182;</a></h3><h3 id="Between-Stages-1---10:-there-were-2-stages">Between Stages 1 - 10: there were 2 stages<a class="anchor-link" href="#Between-Stages-1---10:-there-were-2-stages">&#182;</a></h3><h3 id="Between-Stages-11---20-there-were-4-stages">Between Stages 11 - 20 there were 4 stages<a class="anchor-link" href="#Between-Stages-11---20-there-were-4-stages">&#182;</a></h3><h3 id="Between-Stages-21---30-there-were-6-stages">Between Stages 21 - 30 there were 6 stages<a class="anchor-link" href="#Between-Stages-21---30-there-were-6-stages">&#182;</a></h3><h3 id="Between-Stages-31---38-there-were-5-stages">Between Stages 31 - 38 there were 5 stages<a class="anchor-link" href="#Between-Stages-31---38-there-were-5-stages">&#182;</a></h3><h3 id="These-observations-show-that-the-number-of-stages-with-average-goals-scores-greater-than-the-overall-average-increases-after-stage-11."><font color="red">These observations show that the number of stages with average goals scores greater than the overall average increases after stage 11.</font><a class="anchor-link" href="#These-observations-show-that-the-number-of-stages-with-average-goals-scores-greater-than-the-overall-average-increases-after-stage-11.">&#182;</a></h3>
</div>
</div>
</div>
 

